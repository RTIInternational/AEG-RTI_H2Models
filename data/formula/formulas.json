{
  "formulas": [
    {
      "name": "",
      "label": "Hydrogen Gas Lower Heating Value (LHV) (MJ/kg)",
      "expression": "get_lhv(\"Hydrogen\")",
      "orig_name": "H2_LHV_MJ_p_kg"
    },
    {
      "name": "output_energy_MMBtu_per_year",
      "label": "Actual Hydrogen Energy Produced (MMBtu(LHV)/yr)",
      "expression": "plant_output_kg_per_year * H2_LHV_MJ_p_kg / 1000 / conversion_factor(\"mmBTU_to_GJ\")",
      "orig_name": ""
    },
    {
      "name": "output_energy_MJ_per_year",
      "label": "Actual Hydrogen Energy Produced (MJ(LHV)/yr)",
      "expression": "plant_output_kg_per_year * H2_LHV_MJ_p_kg",
      "orig_name": ""
    },
    {
      "name": "",
      "label": "After-Tax Nominal IRR",
      "expression": "((1 + real_irr) * (1 + inflation_rate)) - 1",
      "orig_name": "nominal_irr"
    },
    {
      "name": "percentage_debt_financing",
      "label": "Debt Financing",
      "expression": "1 - percentage_equity_financing",
      "orig_name": ""
    },
    {
      "name": "target_after_tax_nominal_irr",
      "label": "Target after-tax nominal IRR",
      "expression": "(1 + real_irr)*(1 + inflation_rate) - 1",
      "orig_name": ""
    },
    {
      "name": "analysis_range",
      "expression": "range(analysis_period_start, analysis_period_end)",
      "sample": "range(2012, 2055)"
    },
    {
      "name": "analysis_index_range",
      "expression": "seq_along(analysis_range)",
      "sample": "range(0, 43)"
    },
    {
      "name": "feedstock_price_df",
      "expression": "get_feedstock_price_df(feedstocks, analysis_range, startup_year)"
    },
    {
      "name": "operation_range",
      "expression": "get_operation_range(analysis_index_range, construct)",
      "sample": "[-3, -2, -1, 1, 2, 3, ..., 40]"
    },
    {
      "name": "inflation_price_increase_factors",
      "expression": "get_inflation_price_increase_factors(analysis_range, inflation_rate, startup_year)"
    },
    {
      "name": "total_feedstock_cost_column",
      "label": "Feedstock Cost column",
      "expression": "get_total_feedstock_costs(operation_range, feedstock_price_df, inflation_price_increase_factors, start_time, plant_output_kg_per_year, percnt_var)"
    },
    {
      "orig_name": "direct_cap",
      "label": "H2A Total Direct Capital Cost",
      "expression": "sum(capital_investment_costs(capital_investments))"
    },
    {
      "orig_name": "CO2_seq",
      "label": "H2A Carbon Sequestration Total Direct Capital Cost",
      "expression": "0",
      "todo": "Update formula"
    },
    {
      "name": "site_preparation_cost",
      "label": "Site Preparation ($)",
      "expression": "(0.02 * CO2_seq / (CEPCIinflator * CPIinflator)) + (0.159872128446844 * direct_cap / (CEPCIinflator * CPIinflator))",
      "excel_loc": "Input_Sheet_Template C92",
      "translation_note": "The formula is 2 lines in the spreadsheet; the magic numbers are from it",
      "todo": "These should be user inputs; they vary depending on the workbook default values"
    },
    {
      "name": "engineering_and_design_cost",
      "label": "Engineering and Design ($)",
      "expression": "(0.1 * CO2_seq / (CEPCIinflator * CPIinflator)) + (0.11599636520534 * direct_cap / (CEPCIinflator * CPIinflator))"
    },
    {
      "name": "process_contingency_cost",
      "label": "Process Contingency ($)",
      "expression": "0"
    },
    {
      "name": "project_contingency_cost",
      "label": "Project Contingency ($)",
      "expression": "0.247793627342024 * direct_cap / (CEPCIinflator * CPIinflator)"
    },
    {
      "name": "other_depreciable_capital_cost",
      "label": "Other (Depreciable) Capital ($)",
      "expression": "40137000"
    },
    {
      "name": "upfront_permitting_costs",
      "label": "Upfront Permitting Costs ($)",
      "expression": "(0.15 * CO2_seq / (CEPCIinflator * CPIinflator)) + (0.11599636520534 * direct_cap / (CEPCIinflator * CPIinflator))"
    },
    {
      "orig_name": "depr_cap",
      "label": "Total Depreciable Capital Costs",
      "expression": "direct_cap + CO2_seq + (CEPCIinflator * CPIinflator) * (site_preparation_cost + engineering_and_design_cost + process_contingency_cost + project_contingency_cost + other_depreciable_capital_cost + upfront_permitting_costs)"
    },
    {
      "name": "replacement_costs",
      "label": "Yearly Replacement Costs",
      "expression": "get_replacement_costs(operation_range, inflation_price_increase_factors, replace_factor, depr_cap, ref_year, startup_year, inflation_rate)",
      "excel_loc": "Cash Flow Analysis I64"
    },
    {
      "name": "land_cost",
      "label": "Land Cost ($)",
      "expression": "acres_required * cost_per_acre * CPIinflator"
    },
    {
      "name": "other_non_depreciable_capital_cost",
      "label": "Other Non-Depreciable Capital ($)",
      "expression": "0"
    },
    {
      "name": "non_dep_cap",
      "label": "Non-Depreciable Capital Costs",
      "expression": "land_cost + other_non_depreciable_capital_cost",
      "excel_loc": "Input_Sheet_Template E106"
    },
    {
      "name": "total_cap",
      "label": "Total Capital Costs",
      "expression": "depr_cap + non_dep_cap",
      "excel_loc": "Input_Sheet_Template C108"
    },
    {
      "orig_name": "depr_cap_infl",
      "label": "Total Depreciable Capital Costs",
      "expression": "(total_cap - non_dep_cap) * INFLATION_FACTOR",
      "excel_loc": "Cash Flow Analysis B51"
    },
    {
      "orig_name": "non_dep_infl",
      "label": "Non-Depreciable Capital Costs",
      "expression": "non_dep_cap * INFLATION_FACTOR",
      "excel_loc": "Cash Flow Analysis B52"
    },
    {
      "name": "total_capital_investment",
      "label": "Total Capital Investment",
      "expression": "depr_cap_infl + non_dep_infl",
      "excel_loc": "Cash Flow Analysis B53"
    },
    {
      "name": "initial_equity_depr_cap",
      "label": "Initial Equity Depreciable Capital Column",
      "expression": "get_initial_equity_depr_cap(analysis_index_range, inflation_price_increase_factors, depr_cap_infl, percentage_equity_financing, percent_cap1, percent_cap2, percent_cap3, percent_cap4)",
      "excel_loc": "Cash Flow Analysis H64"
    },
    {
      "name": "other_non_depreciable_capital_cost_column",
      "label": "Other Non-Depreciable Capital Column",
      "expression": "get_other_non_depreciable_capital_cost_column(analysis_index_range, inflation_price_increase_factors, non_dep_infl)",
      "excel_loc": "Cash Flow Analysis K64"
    },
    {
      "orig_name": "decom",
      "label": "Decommissioning",
      "expression": "decom_percent * depr_cap_infl",
      "excel_loc": "Cash Flow Analysis B54"
    },
    {
      "name": "decom_costs_column",
      "label": "Decommissioning Costs Column",
      "expression": "get_decom_costs_column(operation_range, inflation_price_increase_factors, decom, plant_life)",
      "excel_loc": "Cash Flow Analysis M64"
    },
    {
      "orig_name": "salvage",
      "label": "Salvage Value",
      "expression": "salvage_perct * total_capital_investment",
      "excel_loc": "Cash Flow Analysis B55"
    },
    {
      "name": "salvage_column",
      "label": "Salvage Value Column",
      "expression": "get_salvage_column(operation_range, inflation_price_increase_factors, salvage, plant_life)",
      "excel_loc": "Cash Flow Analysis L64"
    },
    {
      "name": "FTE_HOURS_PER_YEAR",
      "expression": "2080"
    },
    {
      "name": "labor_cost_inflator",
      "expression": "get(labor_index, ref_year) / get(labor_index, BasisYear)"
    },
    {
      "orig_name": "labor_cost",
      "label": "Labor Cost ($/year)",
      "expression": "total_plant_staff * (labor_cost_per_hour * labor_cost_inflator) * FTE_HOURS_PER_YEAR",
      "excel_loc": "Input_Sheet_Template E113"
    },
    {
      "orig_name": "overhead_GA",
      "label": "G&A ($/year)",
      "expression": "labor_cost * overhead_rate",
      "excel_loc": "Input_Sheet_Template E115"
    },
    {
      "orig_name": "tax_insurance",
      "label": "Property taxes and insurance ($/year)",
      "expression": "tax_ins_rate * total_cap",
      "excel_loc": "Input_Sheet_Template E118"
    },
    {
      "name": "total_fixed_cost",
      "label": "Total Fixed Operating Costs ($/year)",
      "expression": "labor_cost + overhead_GA + tax_insurance + (CEPCIinflator*CPIinflator) * (licensing + rent + material_cost_maintenance_and_repairs + production_cost_maintenance_and_repairs + other_fees + other_fixed)",
      "excel_loc": "Input_Sheet_Template E124"
    },
    {
      "orig_name": "inflated_fixed",
      "label": "Fixed Operating Costs ($/year)",
      "expression": "total_fixed_cost * INFLATION_FACTOR",
      "excel_loc": "Cash Flow Analysis B56"
    },
    {
      "name": "fixed_cost_column",
      "label": "Fixed Operating Cost",
      "expression": "get_fixed_cost_column(operation_range, inflation_price_increase_factors, inflated_fixed, percnt_fixed, start_time)",
      "excel_loc": "Cash Flow Analysis N64"
    },
    {
      "orig_name": "total_tax_rate",
      "label": "Total Tax Rate (%)",
      "expression": "fed_tax_rate + state_tax_rate * (1 - fed_tax_rate)",
      "excel_loc": "Input_Sheet_Template C55 and Cash Flow Analysis B33"
    },
    {
      "name": "percentage_debt_financing",
      "label": "Debt Financing (%)",
      "expression": "1 - percentage_equity_financing",
      "excel_loc": "Cash Flow Analysis B31"
    },
    {
      "name": "initial_capital_financed",
      "label": "Portion of Initial Depreciable Capital Investment Financed with Debt",
      "expression": "depr_cap_infl * percentage_debt_financing * get(inflation_price_increase_factors, YEAR_1)",
      "excel_loc": "Cash Flow Analysis G65"
    },
    {
      "name": "LAST_ANALYSIS_YEAR",
      "expression": "anal_period + construct - 1"
    },
    {
      "name": "principal_payments_column",
      "label": "Principal Payments Column",
      "expression": "determine_principal_payment(debt_period, analysis_index_range, LAST_ANALYSIS_YEAR, initial_capital_financed)",
      "excel_loc": "Cash Flow Analysis Z64 and Debt Financing Calculations F13"
    },
    {
      "name": "interest_payments_column",
      "label": "Interest Payments Column",
      "expression": "determine_interest_payment(debt_period, analysis_index_range, initial_capital_financed, debt_interest)",
      "excel_loc": "Cash Flow Analysis S64 and Debt Financing Calculations E13"
    },
    {
      "name": "h2_sales_kg_per_year",
      "label": "Hydrogen Sales (kg/year)",
      "expression": "get_h2_sales_kg_per_year(operation_range, plant_output_kg_per_year, percnt_revs, start_time)",
      "excel_loc": "Cash Flow Analysis AE64"
    },
    {
      "name": "discounted_value_total_h2_sales_kg",
      "label": "Discounted Value of Total Hydrogen Sales (kg)",
      "expression": "get(h2_sales_kg_per_year, YEAR_1) + npv(real_irr, skip(h2_sales_kg_per_year, 1))",
      "excel_loc": "Cash Flow Analysis AE116"
    },
    {
      "name": "LCOE_contribution_h2_sales_kg",
      "label": "LCOE Contribution from Hydrogen Sales (kg)",
      "expression": "discounted_value_total_h2_sales_kg * (1 - total_tax_rate)",
      "excel_loc": "Cash Flow Analysis AC57"
    },
    {
      "name": "discounted_value_total_salvage_value",
      "label": "Discounted Value of Total Salvage Value",
      "expression": "get(salvage_column, YEAR_1) + npv(target_after_tax_nominal_irr, skip(salvage_column, 1))",
      "excel_loc": "Cash Flow Analysis L116"
    },
    {
      "name": "nonenergy_material_price_df",
      "expression": "get_nonenergy_material_price_df(nonenergy_materials, analysis_range, INFLATION_FACTOR, ref_year)"
    },
    {
      "orig_name": "var_misc",
      "label": "Variable O&M Costs ($/year)",
      "expression": "other_variable_operating_costs * get(chemical_price_index, ref_year) / get(chemical_price_index, BasisYear)",
      "excel_loc": "Input_Sheet_Template E148"
    },
    {
      "orig_name": "waste_treat",
      "label": "Waste treatment costs ($/year)",
      "expression": "waste_treatment_costs * get(chemical_price_index, ref_year) / get(chemical_price_index, BasisYear)",
      "excel_loc": "Input_Sheet_Template E150"
    },
    {
      "orig_name": "solidwaste_treat",
      "label": "Solid waste disposal costs ($/year)",
      "expression": "solid_waste_disposal_costs * get(chemical_price_index, ref_year) / get(chemical_price_index, BasisYear)",
      "excel_loc": "Input_Sheet_Template E151"
    },
    {
      "orig_name": "CO2_OandMcost",
      "label": "CO2 sequestration O&M costs and credits ($/year)",
      "expression": "0",
      "excel_loc": "Input_Sheet_Template E156"
    },
    {
      "orig_name": "inflated_othervar",
      "label": "Other Variable O&M Costs (not including tax credits and incentives)",
      "expression": "INFLATION_FACTOR * (var_misc + royalties + operator_profit + CO2_OandMcost + waste_treat + solidwaste_treat)",
      "excel_loc": "Cash Flow Analysis B58"
    },
    {
      "name": "variable_cost_column",
      "label": "Other Variable Operating Costs",
      "expression": "get_variable_cost_column(operation_range, analysis_index_range, nonenergy_material_price_df, inflation_price_increase_factors, plant_output_kg_per_year, percnt_var, start_time, inflated_othervar)",
      "excel_loc": "Cash Flow Analysis R64"
    },
    {
      "orig_name": "total_other_raw",
      "label": "Other Material Costs ($/year)",
      "expression": "other_material_costs * get(chemical_price_index, ref_year) / get(chemical_price_index, BasisYear)",
      "excel_loc": "Input_Sheet_Template E149"
    },
    {
      "orig_name": "inflated_otherraw",
      "label": "Other Raw Material ($/year)",
      "expression": "total_other_raw * INFLATION_FACTOR",
      "excel_loc": "Cash Flow Analysis B57"
    },
    {
      "name": "other_raw_material_cost_column",
      "label": "Other Raw Material Cost Column",
      "expression": "get_other_raw_material_cost_column(operation_range, inflation_price_increase_factors, inflated_otherraw, percnt_var, start_time)",
      "excel_loc": "Cash Flow Analysis P64"
    },
    {
      "name": "working_cap_reserve_rows",
      "label": "Working Capital Reserve Rows",
      "expression": "get_working_cap_reserve_rows(slice(operation_range, end = length(operation_range) - 1), slice(analysis_index_range, end = length(analysis_index_range) - 1), WorkingCap, fixed_cost_column, total_feedstock_cost_column, other_raw_material_cost_column, variable_cost_column)"
    },
    {
      "name": "working_cap_reserve_column",
      "label": "Cash from Working Capital Reserve Column",
      "expression": "get_working_cap_reserve_column(working_cap_reserve_rows)",
      "excel_loc": "Cash Flow Analysis J64"
    },
    {
      "name": "#",
      "label": "Total Depreciable Capital Costs",
      "expression": "(total_cap - non_dep_cap) * INFLATION_FACTOR",
      "orig_name": ""
    }
  ]
}